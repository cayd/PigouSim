#Driver

#from simian import Simian
from constants import *

#Initialize Simian
simianEngine = Simian(simName, startTime, endTime, minDelay, useMPI)

simianEngine.addEntity("GridMaster", GridMaster, 0)
pointCount = 1
#i may have meant to add to pointCount each time through the loop: CM no, wait, i think not
for city in grid:
    simianEngine.addEntity(getName(city)+"Producer", Producer, pointCount, city)
    simianEngine.addEntity(getName(city)+"City", City, pointCount, city)
    citiesList.append(getName(city))
    simianEngine.schedService(0, "sendConsumptionPrediction", None, getName(city)+"City", pointCount)


# this loop should have the cities update the grid every hour of their net power surplus
#looking back, that comment^ is not accurate. it updates as many times as possible in the course of the simulation, not by the hour: CM
#hmmm. actually, it does do what it says it does. not sure why: CM
for i in xrange(int(endTime/minDelay)):
    #simianEngine.schedService(i, "checkNet", i, "GridMaster", 0) # i never wrote this service. wonder if it was important: CM
    for j in citiesList:
        simianEngine.schedService(i, "updateDraw", i, j+"City", 1)
        
simianEngine.run()
simianEngine.exit()

